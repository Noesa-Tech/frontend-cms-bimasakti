var H=(x,C,y)=>new Promise((S,k)=>{var I=c=>{try{T(y.next(c))}catch(w){k(w)}},V=c=>{try{T(y.throw(c))}catch(w){k(w)}},T=c=>c.done?S(c.value):Promise.resolve(c.value).then(I,V);T((y=y.apply(x,C)).next())});import{s as _e,a as ye}from"./index-d415334a.js";import{s as ge}from"./index-f6c98b31.js";import{s as be,a as he}from"./index-587dde32.js";import{s as xe}from"./index-812db6ee.js";import{s as ke}from"./index-0db1eb5a.js";import{s as Ve}from"./index-c93f0fa5.js";import{s as Te,a as we}from"./index-aab56334.js";import{a5 as Ce,a6 as Se,p as Ie,v as h,a1 as De,a8 as Pe,q as z,a2 as Ae,Q as Ue,c as g,h as t,a as o,k as A,w as l,z as r,M as F,J as $e,o as m,O as f,t as i,n as j,N as Y,L as Ne,K as W,a3 as u,a4 as p,aa as Re}from"./index-a4806e1d.js";import{s as E,a as Be,b as Le}from"./index-8f2364ad.js";import{s as Me}from"./index-9b60516b.js";import{_ as Oe}from"./TopBreadcrumb-0696f7f6.js";import{s as G,a as Q,b as J,c as X}from"./index-274e956d.js";import{s as He}from"./index-2fe30ee1.js";import{s as Fe}from"./index-07aede61.js";import{s as Z}from"./index-13583865.js";import"./index-b1b6b2fd.js";import"./index-15c61f91.js";import"./index-b323e312.js";import"./_plugin-vue_export-helper-c27b6911.js";const je=Ce("OrderStore",{state:()=>({isLoading:!1,allOrder:[],detail:null}),actions:{fetchOrder(){return H(this,null,function*(){this.isLoading=!0;try{const x=yield Se.get("/auth/orders");this.allOrder=x.data}catch(x){}finally{this.isLoading=!1}})}}}),We={class:"card mt-8"},qe={class:"flex flex-col md:flex-row justify-between gap-4"},Ke={class:"flex items-center gap-4 md:order-2 order-1"},ze={class:"hidden md:flex"},Ye={class:"flex md:hidden"},Ee={class:"text-start"},Ge={class:"m-0"},Qe={class:"m-0 text-sm text-muted-color"},Je={class:"flex flex-col gap-4 w-[25rem]"},Xe={class:"flex gap-4 items-center"},Ze={class:"flex flex-col gap-2"},et={class:"flex items-center justify-start gap-4"},tt=["src","alt"],at={class:"flex flex-col items-start text-start gap-4"},ot={class:"inline-flex"},lt={class:"flex flex-col gap-1"},st={class:"m-0 font-medium"},nt={class:"flex items-center gap-2"},rt={class:"m-0"},it={class:"flex items-center gap-2"},dt={class:"flex items-center gap-2"},ut={class:"m-0"},ct={class:"flex items-center gap-2"},pt={class:"m-0"},mt={class:"m-0"},ft={class:"flex items-center gap-2"},vt={key:0},_t={key:1},yt={class:"flex gap-4 items-center"},gt={class:"flex flex-col gap-4"},bt={class:"flex flex-col gap-2"},ht={class:"flex gap-2 justify-end"},Ft=Ie({__name:"Orders",setup(x){h({});const C=h(),y=h(),S=De(),k=Pe(),I=h(),V=je(),T=h(0),c=h({global:{value:null,matchMode:u.CONTAINS},noInvoice:{operator:p.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},"user.name":{operator:p.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},"user.email":{operator:p.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},"user.phone":{operator:p.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},"service.name":{operator:p.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},"properties.name":{operator:p.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},location:{operator:p.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},vendor:{operator:p.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},total_fee:{operator:p.AND,constraints:[{value:null,matchMode:u.STARTS_WITH}]},date:{operator:p.AND,constraints:[{value:null,matchMode:u.DATE_IS}]},status:{operator:p.OR,constraints:[{value:null,matchMode:u.EQUALS}]},paymentMethod:{operator:p.OR,constraints:[{value:null,matchMode:u.EQUALS}]}}),w=z(["order_confirmed","in_process","on_the_way","work_started","waiting_for_payment","completed"]),ee=z(["Transfer Bank","Virtual Account(VA)","GoPay","OVO"]);function U(n){switch(n){case"order_confirmed":return"contrast";case"in_process":return"warn";case"on_the_way":return"info";case"work_started":return"help";case"waiting_for_payment":return"secondary";case"completed":return"success";default:return"default"}}function $(n){switch(n){case"order_confirmed":return"Pesanan Terkonfirmasi";case"in_process":return"Pesanan Diproses";case"on_the_way":return"Menuju Lokasi";case"work_started":return"Sedang Dikerjakan";case"waiting_for_payment":return"Menunggu Pembayaran";case"completed":return"Selesai";default:return"-"}}function te(n){switch(n){case 0:return"Tidak Butuh Tangga";case 1:return"Butuh Tangga";default:return null}}const ae=Ae(()=>V.allOrder||[]);Ue(()=>H(this,null,function*(){yield V.fetchOrder()}));function oe(n){return new Date(n).toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"})}const le=n=>{S.require({target:n.currentTarget,message:"Yakin ingin membatalkan pesanan ini?",icon:"pi pi-info-circle",rejectProps:{label:"Batal",severity:"secondary",outlined:!0},acceptProps:{label:"Yakin",severity:"danger"},accept:()=>{k.add({severity:"info",summary:"Confirmed",detail:"Pesanan dibatalkan",life:3e3})},reject:()=>{k.add({severity:"error",summary:"Rejected",detail:"You have rejected",life:3e3})}})},se=n=>{S.require({target:n.currentTarget,message:"Yakin ingin meneruskan pesanan ini kepada vendor 'PT Air Conditioner'?",icon:"pi pi-info-circle",rejectProps:{label:"Batal",severity:"secondary",outlined:!0},acceptProps:{label:"Teruskan",severity:"success"},accept:()=>{},reject:()=>{}})},ne=n=>{C.value.toggle(n)},q=n=>{y.value.toggle(n)},re=n=>{I.value.exportCSV()};return(n,a)=>{const ie=Oe,d=be,de=Be,b=Me,ue=Le,v=ye,D=Re,ce=Te,pe=we,K=Ve,P=ke,N=xe,me=he,R=ge,fe=_e,B=$e("tooltip");return m(),g(F,null,[t(ie,{breadcrumbItems:[{label:"Pesanan"}]}),o("div",We,[a[24]||(a[24]=o("div",{class:"font-semibold text-xl mb-4"},"Data Pesanan",-1)),(m(),A(fe,{ref_key:"dt",ref:I,key:T.value,value:r(ae),paginator:!0,rows:10,dataKey:"id",filters:c.value,"onUpdate:filters":a[6]||(a[6]=e=>c.value=e),filterDisplay:"menu",loading:r(V).isLoading,globalFilterFields:["noInvoice","user.name","user.email","user.phone","items","location","service.name","properties.name","total_fee","vendor","date","status"],showGridlines:"",scrollable:""},{header:l(()=>[o("div",qe,[t(d,{type:"button",icon:"pi pi-plus",label:"Tambah Pesanan",class:"md:order-1 order-2",as:"router-link",to:{name:"orders-add"}}),o("div",Ke,[o("div",ze,[t(d,{type:"button",icon:"pi pi-download",outlined:"",label:"Unduh",onClick:a[0]||(a[0]=e=>re(e))})]),o("div",Ye,[t(d,{type:"button",icon:"pi pi-download",outlined:""})]),t(ue,{class:"w-full md:w-auto"},{default:l(()=>[t(de,null,{default:l(()=>a[7]||(a[7]=[o("i",{class:"pi pi-search"},null,-1)])),_:1}),t(b,{modelValue:c.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value.global.value=e),placeholder:"Pencarian",fluid:""},null,8,["modelValue"])]),_:1})])])]),empty:l(()=>a[8]||(a[8]=[f(" No order found. ")])),loading:l(()=>a[9]||(a[9]=[f(" Loading order data. Please wait. ")])),default:l(()=>[t(v,{sortable:"",field:"noInvoice",header:"Invoice",class:"min-w-[15rem]"},{body:l(({data:e})=>[f(i(e.invoice),1)]),filter:l(({filterModel:e})=>[t(b,{modelValue:e.value,"onUpdate:modelValue":s=>e.value=s,type:"text",placeholder:"Cari Invoice"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(v,{sortable:"",field:"user.name",header:"Pelanggan",class:"min-w-[15rem]"},{body:l(({data:e})=>[o("div",Ee,[o("h6",Ge,i(e.user.name),1),o("p",Qe,i(e.user.email),1),o("p",{class:"m-0 text-sm text-primary cursor-pointer hover:text-primary-300 transition-all max-w-fit",onClick:ne},[f(i(e.user.phone),1),a[10]||(a[10]=o("i",{class:"pi pi-angle-down ml-2",style:{"font-size":"0.8rem"}},null,-1))]),t(r(Z),{ref_key:"opPhone",ref:C},{default:l(()=>[o("div",Je,[o("div",null,[a[11]||(a[11]=o("h6",{class:"mb-0"},"Opsi Nomor Telepon",-1)),t(D)]),t(pe,null,{default:l(()=>[t(b,{value:e.user.phone,readonly:"",class:"w-[25rem]"},null,8,["value"]),t(ce,null,{default:l(()=>[t(d,{icon:"pi pi-phone"})]),_:1})]),_:2},1024),o("div",Xe,[t(D),a[12]||(a[12]=o("p",{class:"m-0 text-center text-muted-color text-sm"},"Atau",-1)),t(D)]),o("div",Ze,[a[13]||(a[13]=o("label",{for:"message"},"Kirim Pesan",-1)),t(K,{id:"message"})]),t(d,{icon:"pi pi-send",label:"Kirim Pesan",iconPos:"right"})])]),_:2},1536)])]),filter:l(({filterModel:e})=>[t(b,{modelValue:e.value,"onUpdate:modelValue":s=>e.value=s,type:"text",placeholder:"Cari Pelanggan"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(v,{sortable:"",header:"Lokasi",filterField:"location",class:"min-w-[24rem]"},{body:l(({data:e})=>[f(i(e.location),1)]),filter:l(({filterModel:e})=>[t(b,{modelValue:e.value,"onUpdate:modelValue":s=>e.value=s,type:"text",placeholder:"Cari Kota"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(v,{sortable:"",header:"Layanan",filterField:"service.name",class:"min-w-[40rem]"},{body:l(({data:e})=>[t(r(G),{value:"0"},{default:l(()=>[t(r(Q),{value:"1",class:"accordion-table"},{default:l(()=>[t(r(J),null,{default:l(()=>[o("div",et,[e.service.full_image_url?(m(),g("img",{key:0,src:e.service.full_image_url,alt:e.service.name,class:"h-6 text-sm font-normal"},null,8,tt)):j("",!0),o("span",null,i(e.service.name),1)])]),_:2},1024),t(r(X),null,{default:l(()=>[t(D),t(r(G),{value:"0"},{default:l(()=>[(m(!0),g(F,null,Y(e.problems,(s,L)=>(m(),A(r(Q),{key:s.name,value:L},{default:l(()=>[t(r(J),{class:Ne({"accordion-subheader":e.service.image_url})},{default:l(()=>[f(i(s.name),1)]),_:2},1032,["class"]),t(r(X),{class:"accordion-content"},{default:l(()=>[o("div",at,[(m(!0),g(F,null,Y(s.sub_problem,(_,ve)=>(m(),g("ol",{key:ve,class:"list-disc list-inside"},[o("li",null,[o("div",ot,[o("div",lt,[o("p",st,"Kategori: "+i(_.name),1),o("div",nt,[a[17]||(a[17]=o("p",{class:"m-0"},"QTY:",-1)),t(N,{class:"inplace-custom-display"},{display:l(()=>[o("p",rt,[f(i(_.qty),1),a[14]||(a[14]=o("i",{class:"pi pi-pencil ml-2"},null,-1))])]),content:l(({closeCallback:M})=>[o("div",it,[t(P,{modelValue:_.qty,"onUpdate:modelValue":O=>_.qty=O,inputId:"horizontal-buttons",showButtons:"",buttonLayout:"horizontal",min:0,max:99,inputClass:" text-center border-l border-l-red-500 border-r border-r-green-500 bg-transparent max-w-[4rem]",incrementButtonClass:"border-green-500",decrementButtonClass:"border-red-500",small:""},{incrementbuttonicon:l(()=>a[15]||(a[15]=[o("span",{class:"pi pi-plus"},null,-1)])),decrementbuttonicon:l(()=>a[16]||(a[16]=[o("span",{class:"pi pi-minus"},null,-1)])),_:2},1032,["modelValue","onUpdate:modelValue"]),t(d,{icon:"pi pi-check",outlined:"",severity:"success",onClick:M},null,8,["onClick"])])]),_:2},1024)]),o("div",dt,[a[19]||(a[19]=o("p",{class:"m-0"},"Harga:",-1)),t(N,{class:"inplace-custom-display"},{display:l(()=>[o("p",ut,[f("Rp"+i(n.formatPrice(_.price)),1),a[18]||(a[18]=o("i",{class:"pi pi-pencil ml-2"},null,-1))])]),content:l(({closeCallback:M})=>[o("div",ct,[t(P,{modelValue:_.price,"onUpdate:modelValue":O=>_.price=O,type:"text",placeholder:"Cari Harga",inputId:"currency-indonesia",mode:"currency",currency:"IDR",locale:"id-ID",minFractionDigits:0},null,8,["modelValue","onUpdate:modelValue"]),t(d,{icon:"pi pi-check",outlined:"",severity:"success",onClick:M},null,8,["onClick"])])]),_:2},1024)])])])])]))),128))])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),t(v,{field:"properties.name",header:"Jenis Property",class:"min-w-[15rem]",sortable:""},{body:l(({data:e})=>{var s;return[o("div",null,[o("p",pt,i(e.properties.name),1),e.isLadderRequired?(m(),A(me,{key:0,value:(s=te(e.isLadderRequired))!=null?s:"",size:"small",class:"mb-2"},null,8,["value"])):j("",!0),t(N,{class:"inplace-custom-display"},{display:l(()=>[o("p",mt,[f("Rp"+i(n.formatPrice(e.properties.fee)),1),a[20]||(a[20]=o("i",{class:"pi pi-pencil ml-2"},null,-1))])]),content:l(({closeCallback:L})=>[o("div",ft,[t(P,{modelValue:e.properties.fee,"onUpdate:modelValue":_=>e.properties.fee=_,type:"text",placeholder:"Cari Harga",inputId:"currency-indonesia",mode:"currency",currency:"IDR",locale:"id-ID",minFractionDigits:0},null,8,["modelValue","onUpdate:modelValue"]),t(d,{icon:"pi pi-check",outlined:"",severity:"success",onClick:L},null,8,["onClick"])])]),_:2},1024)])]}),filter:l(({filterModel:e})=>[t(b,{modelValue:e.value,"onUpdate:modelValue":s=>e.value=s,type:"text",placeholder:"Cari Property"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(v,{sortable:"",field:"total_fee",header:"Total Harga",class:"min-w-[15rem]"},{body:l(({data:e})=>[e.total_fee?(m(),g("span",vt,"Rp"+i(n.formatPrice(e.total_fee)),1)):(m(),g("span",_t,"Harga belum ditentukan"))]),filter:l(({filterModel:e})=>[t(P,{modelValue:e.value,"onUpdate:modelValue":s=>e.value=s,type:"text",placeholder:"Cari Harga",inputId:"currency-indonesia",mode:"currency",currency:"IDR",locale:"id-ID",minFractionDigits:0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(v,{sortable:"",header:"Status",field:"status",filterMenuStyle:{width:"18rem"},class:"min-w-[20rem]"},{body:l(({data:e})=>[t(R,{value:$(e.status),severity:U(e.status),class:"whitespace-nowrap"},null,8,["value","severity"])]),filter:l(({filterModel:e})=>[t(r(E),{modelValue:e.value,"onUpdate:modelValue":s=>e.value=s,options:w,placeholder:"Pilih",showClear:""},{value:l(s=>[s.value!=null?(m(),A(R,{key:0,value:$(s.value),severity:U(s.value)},null,8,["value","severity"])):j("",!0)]),option:l(s=>[t(R,{value:$(s.option),severity:U(s.option)},null,8,["value","severity"])]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),_:1}),t(v,{sortable:"",field:"paymentMethod",header:"Metode Pembayaran",class:"min-w-[15rem]"},{body:l(({data:e})=>a[21]||(a[21]=[f(" Bank Transfer ")])),filter:l(({filterModel:e})=>[t(r(E),{modelValue:e.value,"onUpdate:modelValue":s=>e.value=s,options:ee,placeholder:"Pilih",showClear:""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),t(v,{sortable:"",header:"Tanggal Pesanan",filterField:"date",dataType:"date",class:"min-w-[20rem]"},{body:l(({data:e})=>[f(i(oe(e.created_at)),1)]),filter:l(({filterModel:e})=>[t(r(He),{modelValue:e.value,"onUpdate:modelValue":s=>e.value=s,dateFormat:"mm/dd/yy",placeholder:"mm/dd/yyyy"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(v,{sortable:"",field:"id",header:"Action",bodyClass:"text-center",class:"min-w-[10rem]"},{body:l(({data:e})=>[o("div",yt,[W(t(d,{icon:"pi pi-external-link",severity:"info",text:"",as:"router-link",to:{name:"order-detail",params:{id:e.id}}},null,8,["to"]),[[B,"Detail Pesanan",void 0,{bottom:!0}]]),W(t(d,{icon:"pi pi-send",severity:"success",text:"",onClick:a[2]||(a[2]=s=>se(s))},null,512),[[B,"Teruskan Pesanan",void 0,{bottom:!0}]]),W(t(d,{icon:"pi pi-times",severity:"danger",text:"",onClick:a[3]||(a[3]=s=>q(s))},null,512),[[B,"Batalkan",void 0,{bottom:!0}]]),t(r(Z),{ref_key:"opCancelConfirm",ref:y,class:"p-0 min-w-[20rem]"},{default:l(()=>[a[23]||(a[23]=o("h6",{class:"mb-2"},"Pembatalan Pesanan",-1)),o("div",gt,[o("div",bt,[a[22]||(a[22]=o("label",{for:"message"},"Beri alasan",-1)),t(K,{id:"message"})]),o("div",ht,[t(d,{label:"Batal",severity:"secondary",text:"",onClick:a[4]||(a[4]=s=>q(s))}),t(d,{label:"Submit",onClick:a[5]||(a[5]=s=>le(s))})])])]),_:1},512)])]),_:1})]),_:1},8,["value","filters","loading"]))]),t(r(Fe))],64)}}});export{Ft as default};

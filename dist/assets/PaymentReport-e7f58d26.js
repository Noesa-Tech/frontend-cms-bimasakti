import{s as ue,a as me}from"./index-14910fd4.js";import{s as ce}from"./index-02e8bb08.js";import{s as pe,a as fe}from"./index-f8a1cad7.js";import{s as _e}from"./index-e4860a36.js";import{s as ve}from"./index-ddc9d307.js";import{d as ye,a as y,V as B,P as xe,c as g,f as l,b as e,t as r,e as s,E as S,J as o,i as F,L as D,z as be,o as p,N as _,H,M as j,F as ge,D as he,W as d,X as u,ah as Ve}from"./index-e5ca3fe9.js";import{s as Te,a as we}from"./index-3531a741.js";import{s as ke}from"./index-c3a9aed6.js";import{_ as Se}from"./TopBreadcrumb-e2acffae.js";import{s as W,a as O,b as K,c as q}from"./index-68fa4ec2.js";import{s as z}from"./index-df83a9f3.js";import{S as De}from"./service-2705930e.js";import{O as Ie}from"./order-2456bb2e.js";import"./index-f0f285fd.js";import"./index-d21f1610.js";import"./index-96e40a09.js";import"./index-8b098753.js";import"./index-fc9686cf.js";import"./index-65cea784.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./index-1962eafd.js";const Ae={class:"grid grid-cols-12 gap-8 mt-8"},Ce={class:"col-span-12 lg:col-span-6 xl:col-span-4"},Ue={class:"card mb-0"},Re={class:"flex justify-between mb-4"},Me={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},Ne={class:"col-span-12 lg:col-span-6 xl:col-span-4"},Pe={class:"card mb-0"},$e={class:"flex justify-between mb-4"},Le={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},Be={class:"col-span-12 lg:col-span-6 xl:col-span-4"},Fe={class:"card mb-0"},He={class:"flex justify-between mb-4"},je={class:"text-surface-900 dark:text-surface-0 font-medium text-xl"},We={class:"card mt-8"},Oe={class:"flex flex-col md:flex-row justify-end gap-4"},Ke=["onClick"],qe={class:"flex items-center gap-4 md:order-2 order-1"},ze={class:"hidden md:flex"},Ee={class:"flex md:hidden"},Je={class:"flex flex-col text-start w-full"},Qe={class:"m-0"},Ge={class:"m-0 text-sm text-muted-color"},Ye={class:"m-0 text-sm text-muted-color"},Xe={class:"flex items-center justify-start gap-4"},Ze=["src","alt"],et={class:"flex flex-col items-start text-start gap-4 w-full"},tt={class:"flex flex-col gap-1 w-full"},at={class:"m-0 font-semibold"},lt={class:"border rounded-md"},ot={class:"flex items-start justify-between gap-4"},st={class:"m-0"},rt={class:"m-0"},nt={class:"flex flex-col gap-2 p-2"},it={class:"flex items-center justify-start gap-2"},dt={class:"flex items-center justify-start gap-2"},ut={class:"m-0"},mt={class:"m-0 text-sm text-muted-color"},ct={class:"flex flex-col text-start w-full"},pt={class:"m-0"},ft={class:"m-0 text-sm text-muted-color"},_t={class:"flex gap-4 items-center"},Bt=ye({__name:"PaymentReport",setup(vt){const f=Ie(),I=De(),E=y(!1),A=y(),x=y({global:{value:null,matchMode:d.CONTAINS},"customer.name":{operator:u.AND,constraints:[{value:null,matchMode:d.STARTS_WITH}]},"customer.phone":{operator:u.AND,constraints:[{value:null,matchMode:d.STARTS_WITH}]},"customer.email":{operator:u.AND,constraints:[{value:null,matchMode:d.STARTS_WITH}]},"vendor.name":{operator:u.AND,constraints:[{value:null,matchMode:d.STARTS_WITH}]},"service.name":{operator:u.AND,constraints:[{value:null,matchMode:d.STARTS_WITH}]},"property.name":{operator:u.AND,constraints:[{value:null,matchMode:d.STARTS_WITH}]},paymentMethod:{operator:u.AND,constraints:[{value:null,matchMode:d.STARTS_WITH}]},description:{operator:u.AND,constraints:[{value:null,matchMode:d.STARTS_WITH}]},location:{operator:u.AND,constraints:[{value:null,matchMode:d.STARTS_WITH}]},date:{operator:u.AND,constraints:[{value:null,matchMode:d.DATE_IS}]},useLadder:{operator:u.OR,constraints:[{value:null,matchMode:d.EQUALS}]}}),J=y(0),T=y(),w=y("");B(()=>I.serviceAll||[]);const Q=B(()=>f.allOrder||[]);function G(i){switch(i){case 0:return"Tidak Butuh Tangga";case 1:return"Butuh Tangga";default:return null}}xe(async()=>{var a;const i=localStorage.getItem("AuthStore");if(i){const b=JSON.parse(i);w.value=(a=b==null?void 0:b.users)==null?void 0:a.city_id}await f.fetchOrder("completed",w.value),await f.fetchSummaryOrder(w.value),await I.fetchService()});function Y(i){return new Date(i).toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"})}const X=i=>{A.value.exportCSV()};return(i,a)=>{var C,U,R,M,N,P,$,L;const b=Se,h=pe,Z=Te,v=ke,ee=we,m=me,te=Ve,k=ve,ae=_e,le=fe,oe=ce,se=ue,re=be("tooltip");return p(),g(D,null,[l(b,{breadcrumbItems:[{label:"Laporan Keuangan"}]}),e("div",Ae,[e("div",Ce,[e("div",Ue,[e("div",Re,[e("div",null,[a[4]||(a[4]=e("span",{class:"block text-muted-color font-medium mb-4"},"Transaksi Berhasil",-1)),e("div",Me,r((U=(C=s(f))==null?void 0:C.summary)==null?void 0:U.order_complete),1)]),a[5]||(a[5]=e("div",{class:"flex items-center justify-center bg-blue-100 dark:bg-blue-400/10 rounded-border",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-shopping-cart text-blue-500 !text-xl"})],-1))]),a[6]||(a[6]=e("span",{class:"text-primary font-medium"},"24 baru ",-1)),a[7]||(a[7]=e("span",{class:"text-muted-color"},"dari kunjungan terakhir",-1))])]),e("div",Ne,[e("div",Pe,[e("div",$e,[e("div",null,[a[8]||(a[8]=e("span",{class:"block text-muted-color font-medium mb-4"},"Pendapatan",-1)),e("div",Le,"Rp"+r(i.formatPrice((M=(R=s(f))==null?void 0:R.summary)!=null&&M.total_fee?(P=(N=s(f))==null?void 0:N.summary)==null?void 0:P.total_fee:0)),1)]),a[9]||(a[9]=e("div",{class:"flex items-center justify-center bg-orange-100 dark:bg-orange-400/10 rounded-border",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-dollar text-orange-500 !text-xl"})],-1))]),a[10]||(a[10]=e("span",{class:"text-primary font-medium"},"%12+ ",-1)),a[11]||(a[11]=e("span",{class:"text-muted-color"},"dari bulan lalu",-1))])]),e("div",Be,[e("div",Fe,[e("div",He,[e("div",null,[a[12]||(a[12]=e("span",{class:"block text-muted-color font-medium mb-4"},"Pelanggan",-1)),e("div",je,r((L=($=s(f))==null?void 0:$.summary)==null?void 0:L.total_users),1)]),a[13]||(a[13]=e("div",{class:"flex items-center justify-center bg-cyan-100 dark:bg-cyan-400/10 rounded-border",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-users text-cyan-500 !text-xl"})],-1))]),a[14]||(a[14]=e("span",{class:"text-primary font-medium"},"12 ",-1)),a[15]||(a[15]=e("span",{class:"text-muted-color"},"Pelanggan baru",-1))])])]),e("div",We,[a[25]||(a[25]=e("div",{class:"font-semibold text-xl mb-4"},"Laporan Keuangan",-1)),(p(),S(se,{ref_key:"dt",ref:A,key:s(J),value:s(Q),rowGroupMode:"rowspan",groupRowsBy:"customer.name",paginator:!0,rows:10,dataKey:"id",filters:s(x),"onUpdate:filters":a[3]||(a[3]=t=>F(x)?x.value=t:null),filterDisplay:"menu",loading:s(E),globalFilterFields:["customer.name","customer.phone","customer.email","service.name","property.name","paymentMethod","location","price","useLadder","date"],showGridlines:""},{header:o(()=>[e("div",Oe,[l(s(z),{modelValue:s(T),"onUpdate:modelValue":a[0]||(a[0]=t=>F(T)?T.value=t:null),selectionMode:"range",manualInput:!1,showIcon:"",iconDisplay:"input",placeholder:"Pilih tanggal"},{inputicon:o(t=>[e("i",{class:"pi pi-calendar",onClick:t.clickCallback},null,8,Ke)]),_:1},8,["modelValue"]),e("div",qe,[e("div",ze,[l(h,{type:"button",icon:"pi pi-download",outlined:"",label:"Unduh",onClick:a[1]||(a[1]=t=>X(t))})]),e("div",Ee,[l(h,{type:"button",icon:"pi pi-download",outlined:""})]),l(ee,{class:"w-full md:w-auto"},{default:o(()=>[l(Z,null,{default:o(()=>a[16]||(a[16]=[e("i",{class:"pi pi-search"},null,-1)])),_:1}),l(v,{modelValue:s(x).global.value,"onUpdate:modelValue":a[2]||(a[2]=t=>s(x).global.value=t),placeholder:"Pencarian",fluid:""},null,8,["modelValue"])]),_:1})])])]),empty:o(()=>a[17]||(a[17]=[_(" Tidak ada data Kategori. ")])),loading:o(()=>a[18]||(a[18]=[_(" Memuat data Kategori. Mohon tunggu. ")])),default:o(()=>[l(m,{field:"customer.name",header:"Pelanggan",sortable:""},{body:o(({data:t})=>[e("div",Je,[e("h6",Qe,r(t.order_name),1),e("p",Ge,r(t.order_phone),1),e("p",Ye,r(t.order_email),1)])]),filter:o(({filterModel:t})=>[l(v,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n,type:"text",placeholder:"Cari Pelanggan"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(m,{header:"Lokasi",filterField:"location",dataType:"text",class:"min-w-[20rem]",sortable:""},{body:o(({data:t})=>[_(r(t.location),1)]),filter:o(({filterModel:t})=>[l(v,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n,type:"text",placeholder:"Cari Lokasin"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(m,{sortable:"",header:"Layanan",filterField:"service.name",class:"min-w-[40rem]"},{body:o(({data:t})=>[l(s(W),{value:"0"},{default:o(()=>[l(s(O),{value:"1",class:"accordion-table"},{default:o(()=>[l(s(K),null,{default:o(()=>[e("div",Xe,[t.service.full_image_url?(p(),g("img",{key:0,src:t.service.full_image_url,alt:t.service.name,class:"h-6 text-sm font-normal"},null,8,Ze)):H("",!0),e("span",null,r(t.service.name),1)])]),_:2},1024),l(s(q),null,{default:o(()=>[l(te),l(s(W),{value:"0"},{default:o(()=>[(p(!0),g(D,null,j(t.problems,(n,ne)=>(p(),S(s(O),{key:n.name,value:ne},{default:o(()=>[l(s(K),{class:ge({"accordion-subheader":t.service.image_url})},{default:o(()=>[_(r(n.name),1)]),_:2},1032,["class"]),l(s(q),{class:"accordion-content"},{default:o(()=>[e("div",et,[(p(!0),g(D,null,j(n.sub_problem,(c,ie)=>(p(),g("div",{key:ie,class:"w-full"},[e("div",tt,[e("p",at,"â€¢ Kategori: "+r(c.name),1),e("div",lt,[l(ae,{class:"inplace-display-full"},{display:o(()=>[e("div",ot,[e("div",null,[e("p",st,"QTY: "+r(c.qty),1),e("p",rt,"Harga: Rp"+r(i.formatPrice(c.price)),1)]),a[19]||(a[19]=e("i",{class:"pi pi-pencil ml-2"},null,-1))])]),content:o(({closeCallback:de})=>[e("div",nt,[e("div",it,[a[22]||(a[22]=e("p",{class:"m-0"},"QTY: ",-1)),l(k,{modelValue:c.qty,"onUpdate:modelValue":V=>c.qty=V,inputId:"horizontal-buttons",showButtons:"",buttonLayout:"horizontal",min:0,max:99,inputClass:" text-center border-l border-l-red-500 border-r border-r-green-500 bg-transparent max-w-[4rem]",incrementButtonClass:"border-green-500",decrementButtonClass:"border-red-500",small:""},{incrementbuttonicon:o(()=>a[20]||(a[20]=[e("span",{class:"pi pi-plus"},null,-1)])),decrementbuttonicon:o(()=>a[21]||(a[21]=[e("span",{class:"pi pi-minus"},null,-1)])),_:2},1032,["modelValue","onUpdate:modelValue"])]),e("div",dt,[a[23]||(a[23]=e("p",{class:"m-0"},"Harga: ",-1)),l(k,{modelValue:c.price,"onUpdate:modelValue":V=>c.price=V,type:"text",placeholder:"Masukkan Harga",inputId:"currency-indonesia",mode:"currency",currency:"IDR",locale:"id-ID",minFractionDigits:0},null,8,["modelValue","onUpdate:modelValue"])]),l(h,{label:"Simpan",icon:"pi pi-check",outlined:"",severity:"success",class:"max-w-fit",onClick:V=>i.updatePrice(de,c,t.id,c.id)},null,8,["onClick"])])]),_:2},1024)])])]))),128))])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),l(m,{field:"property.name",header:"Jenis Property",class:"min-w-[15rem]",sortable:""},{body:o(({data:t})=>[e("div",null,[e("p",ut,r(t.properties.name),1),t.isLadderRequired?(p(),S(le,{key:0,value:G(t.isLadderRequired)??"",size:"small",class:"mb-2"},null,8,["value"])):H("",!0),e("p",mt,"Rp"+r(i.formatPrice(t.properties.fee)),1)])]),filter:o(({filterModel:t})=>[l(v,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n,type:"text",placeholder:"Cari Property"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(m,{header:"Total Harga",filterField:"price",dataType:"text",class:"min-w-[12rem]",sortable:""},{body:o(({data:t})=>[_(" Rp"+r(i.formatPrice(t.total_fee)),1)]),filter:o(({filterModel:t})=>[l(k,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n,type:"text",placeholder:"Cari Harga",inputId:"currency-indonesia",mode:"currency",currency:"IDR",locale:"id-ID",minFractionDigits:0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(m,{field:"vendor.name",header:"Vendor",class:"min-w-[15rem]",sortable:""},{body:o(({data:t})=>[e("div",ct,[e("p",pt,r(t.vendor_id.name),1),e("p",ft,r(t.vendor_id.code),1)])]),filter:o(({filterModel:t})=>[l(v,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n,type:"text",placeholder:"Cari Vendor"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(m,{header:"Status",field:"status",sortable:""},{body:o(({data:t})=>[l(oe,{value:"Selesai",severity:"success",class:"whitespace-nowrap"})]),_:1}),l(m,{header:"Metode Pembayaran",filterField:"paymentMethod",dataType:"text",class:"min-w-[12rem]",sortable:""},{body:o(({data:t})=>a[24]||(a[24]=[_(" Bank Transfer ")])),filter:o(({filterModel:t})=>[l(v,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n,type:"text",placeholder:"Cari Metode Pembayaran"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(m,{header:"Tanggal Transaksi",filterField:"date",dataType:"date",class:"min-w-[12rem]",sortable:""},{body:o(({data:t})=>[_(r(Y(t.created_at)),1)]),filter:o(({filterModel:t})=>[l(s(z),{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n,dateFormat:"mm/dd/yy",placeholder:"mm/dd/yyyy"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(m,{field:"id",header:"Action",bodyClass:"text-center",class:"min-w-[10rem]",sortable:""},{body:o(({data:t})=>[e("div",_t,[he(l(h,{icon:"pi pi-external-link",severity:"info",text:"",as:"router-link",to:{name:"order-detail",params:{id:t.id}}},null,8,["to"]),[[re,"Detail Pesanan",void 0,{bottom:!0}]])])]),_:1})]),_:1},8,["value","filters","loading"]))])],64)}}});export{Bt as default};

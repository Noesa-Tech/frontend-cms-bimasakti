import{s as be,a as he}from"./index-547ca5e5.js";import{s as Ve}from"./index-525c2035.js";import{s as xe,a as ke}from"./index-9ddf3d55.js";import{s as we}from"./index-d7ab0596.js";import{s as Te}from"./index-b12d1d5d.js";import{s as Ce}from"./index-ed61ab51.js";import{s as Se,a as Ie}from"./index-ef5991cc.js";import{d as De,a as h,S as Pe,a8 as Ue,r as $,V as K,P as Ae,c as g,f as t,b as o,D as T,J as l,e as r,L as N,y as $e,o as p,N as v,H as i,G as R,M as G,E as Ne,z as B,W as c,X as u,ab as Re}from"./index-2917ce10.js";import{s as Be,a as Oe}from"./index-6372ac25.js";import{s as He}from"./index-9ea91010.js";import{_ as Me}from"./TopBreadcrumb-739057b0.js";import{s as Y,a as Q,b as J,c as X}from"./index-ce958058.js";import{s as Le}from"./index-639abafc.js";import{s as O}from"./index-5646386e.js";import{s as je}from"./index-6240175d.js";import{V as Fe,s as Z}from"./index-b3aec2fa.js";import{O as We}from"./order-304944f5.js";import"./index-4a56db6f.js";import"./index-002ee94f.js";import"./index-2f177586.js";import"./index-83a3f0d6.js";import"./index-775fa504.js";import"./_plugin-vue_export-helper-c27b6911.js";const qe={class:"card mt-8"},ze={class:"flex flex-col md:flex-row justify-between gap-4"},Ee={class:"flex items-center gap-4 md:order-2 order-1"},Ke={class:"hidden md:flex"},Ge={class:"flex md:hidden"},Ye={class:"text-start"},Qe={class:"m-0"},Je={class:"m-0 text-sm text-muted-color"},Xe={class:"flex flex-col gap-4 w-[25rem]"},Ze={class:"flex gap-4 items-center"},et={class:"flex flex-col gap-2"},tt={class:"flex items-center justify-start gap-4"},at=["src","alt"],ot={class:"flex flex-col items-start text-start gap-4"},lt={class:"inline-flex"},nt={class:"flex flex-col gap-1"},st={class:"m-0 font-medium"},rt={class:"flex items-center gap-2"},it={class:"m-0"},dt={class:"flex items-center gap-2"},ct={class:"flex items-center gap-2"},ut={class:"m-0"},mt={class:"flex items-center gap-2"},pt={class:"m-0"},vt={class:"m-0"},ft={class:"flex items-center gap-2"},_t={key:0},yt={key:1},gt={class:"flex gap-4 items-center"},bt={class:"flex flex-col gap-4"},ht={class:"flex flex-col gap-2"},Vt={class:"flex gap-2 justify-end"},Et=De({__name:"Orders",setup(xt){h({});const H=h(),M=h(),L=Pe(),ee=Ue(),j=h(),b=We(),F=Fe(),f=$({vendor:null,reason:""}),W=h(0),x=h({global:{value:null,matchMode:c.CONTAINS},noInvoice:{operator:u.AND,constraints:[{value:null,matchMode:c.STARTS_WITH}]},"user.name":{operator:u.AND,constraints:[{value:null,matchMode:c.STARTS_WITH}]},"user.email":{operator:u.AND,constraints:[{value:null,matchMode:c.STARTS_WITH}]},"user.phone":{operator:u.AND,constraints:[{value:null,matchMode:c.STARTS_WITH}]},"service.name":{operator:u.AND,constraints:[{value:null,matchMode:c.STARTS_WITH}]},"properties.name":{operator:u.AND,constraints:[{value:null,matchMode:c.STARTS_WITH}]},location:{operator:u.AND,constraints:[{value:null,matchMode:c.STARTS_WITH}]},vendor:{operator:u.AND,constraints:[{value:null,matchMode:c.STARTS_WITH}]},total_fee:{operator:u.AND,constraints:[{value:null,matchMode:c.STARTS_WITH}]},date:{operator:u.AND,constraints:[{value:null,matchMode:c.DATE_IS}]},status:{operator:u.OR,constraints:[{value:null,matchMode:c.EQUALS}]},paymentMethod:{operator:u.OR,constraints:[{value:null,matchMode:c.EQUALS}]}}),te=$(["order_confirmed","in_process","on_the_way","work_started","waiting_for_payment","completed"]),ae=$(["Transfer Bank","Virtual Account(VA)","GoPay","OVO"]);function C(s){switch(s){case"order_confirmed":return"contrast";case"in_process":return"warn";case"on_the_way":return"info";case"work_started":return"help";case"waiting_for_payment":return"secondary";case"completed":return"success";default:return"default"}}function S(s){switch(s){case"order_confirmed":return"Pesanan Terkonfirmasi";case"in_process":return"Pesanan Diproses";case"on_the_way":return"Menuju Lokasi";case"work_started":return"Sedang Dikerjakan";case"waiting_for_payment":return"Menunggu Pembayaran";case"completed":return"Selesai";default:return"-"}}function oe(s){switch(s){case 0:return"Tidak Butuh Tangga";case 1:return"Butuh Tangga";default:return null}}const le=K(()=>F.vendors.map(s=>({id:s.id,code:s.id,name:s.name,location:s.address,date:s.created_at,status:s.deleted_at,city:s.city,services:s.vendor_service}))),ne=K(()=>b.allOrder||[]);async function q(){await b.fetchOrder(),W.value+=1}Ae(async()=>{await b.fetchOrder("order_confirmed"),await F.fetchVendor()});function se(s){return new Date(s).toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"})}const re=s=>{L.require({target:s.currentTarget,message:"Yakin ingin membatalkan pesanan ini?",icon:"pi pi-info-circle",rejectProps:{label:"Batal",severity:"secondary",outlined:!0},acceptProps:{label:"Yakin",severity:"danger"},accept:async()=>{await b.rejectOrder(f.vendor.id,s,f.reason),await q()},reject:()=>{}})},ie=s=>{if(!f.vendor||!f.vendor.name)return ee.add({severity:"error",summary:"Error",detail:"Vendor belum dipilih"});L.require({target:s.currentTarget,message:`Yakin ingin meneruskan pesanan ini kepada vendor '${f.vendor.name}'?`,icon:"pi pi-info-circle",rejectProps:{label:"Batal",severity:"secondary",outlined:!0},acceptProps:{label:"Teruskan",severity:"success"},accept:async()=>{await b.acceptOrder(f.vendor.id,s),await q()},reject:()=>{}})},de=s=>{H.value.toggle(s)},z=s=>{M.value.toggle(event)},ce=s=>{j.value.exportCSV()};return(s,a)=>{const ue=Me,d=xe,me=Be,_=He,pe=Oe,m=he,k=Re,ve=Se,fe=Ie,E=Ce,w=Te,I=we,_e=ke,D=Ve,ye=be,P=$e("tooltip");return p(),g(N,null,[t(ue,{breadcrumbItems:[{label:"Pesanan"}]}),o("div",qe,[a[23]||(a[23]=o("div",{class:"font-semibold text-xl mb-4"},"Data Pesanan",-1)),(p(),T(ye,{ref_key:"dt",ref:j,key:W.value,value:r(ne),paginator:!0,rows:10,dataKey:"id",filters:x.value,"onUpdate:filters":a[5]||(a[5]=e=>x.value=e),filterDisplay:"menu",loading:r(b).isLoading,globalFilterFields:["noInvoice","user.name","user.email","user.phone","items","location","service.name","properties.name","total_fee","vendor","date","status"],showGridlines:"",scrollable:""},{header:l(()=>[o("div",ze,[t(d,{type:"button",icon:"pi pi-plus",label:"Tambah Pesanan",class:"md:order-1 order-2",as:"router-link",to:{name:"orders-add"}}),o("div",Ee,[o("div",Ke,[t(d,{type:"button",icon:"pi pi-download",outlined:"",label:"Unduh",onClick:a[0]||(a[0]=e=>ce(e))})]),o("div",Ge,[t(d,{type:"button",icon:"pi pi-download",outlined:""})]),t(pe,{class:"w-full md:w-auto"},{default:l(()=>[t(me,null,{default:l(()=>a[6]||(a[6]=[o("i",{class:"pi pi-search"},null,-1)])),_:1}),t(_,{modelValue:x.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value.global.value=e),placeholder:"Pencarian",fluid:""},null,8,["modelValue"])]),_:1})])])]),empty:l(()=>a[7]||(a[7]=[v(" No order found. ")])),loading:l(()=>a[8]||(a[8]=[v(" Loading order data. Please wait. ")])),default:l(()=>[t(m,{sortable:"",field:"noInvoice",header:"Invoice",class:"min-w-[15rem]"},{body:l(({data:e})=>[v(i(e.invoice),1)]),filter:l(({filterModel:e})=>[t(_,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,type:"text",placeholder:"Cari Invoice"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{sortable:"",field:"user.name",header:"Pelanggan",class:"min-w-[15rem]"},{body:l(({data:e})=>[o("div",Ye,[o("h6",Qe,i(e.user.name),1),o("p",Je,i(e.user.email),1),o("p",{class:"m-0 text-sm text-primary cursor-pointer hover:text-primary-300 transition-all max-w-fit",onClick:de},[v(i(e.user.phone),1),a[9]||(a[9]=o("i",{class:"pi pi-angle-down ml-2",style:{"font-size":"0.8rem"}},null,-1))]),t(r(Z),{ref_key:"opPhone",ref:H},{default:l(()=>[o("div",Xe,[o("div",null,[a[10]||(a[10]=o("h6",{class:"mb-0"},"Opsi Nomor Telepon",-1)),t(k)]),t(fe,null,{default:l(()=>[t(_,{value:e.user.phone,readonly:"",class:"w-[25rem]"},null,8,["value"]),t(ve,null,{default:l(()=>[t(d,{icon:"pi pi-phone"})]),_:1})]),_:2},1024),o("div",Ze,[t(k),a[11]||(a[11]=o("p",{class:"m-0 text-center text-muted-color text-sm"},"Atau",-1)),t(k)]),o("div",et,[a[12]||(a[12]=o("label",{for:"message"},"Kirim Pesan",-1)),t(E,{id:"message"})]),t(d,{icon:"pi pi-send",label:"Kirim Pesan",iconPos:"right"})])]),_:2},1536)])]),filter:l(({filterModel:e})=>[t(_,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,type:"text",placeholder:"Cari Pelanggan"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{sortable:"",header:"Lokasi",filterField:"location",class:"min-w-[24rem]"},{body:l(({data:e})=>[v(i(e.location),1)]),filter:l(({filterModel:e})=>[t(_,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,type:"text",placeholder:"Cari Kota"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{sortable:"",header:"Layanan",filterField:"service.name",class:"min-w-[40rem]"},{body:l(({data:e})=>[t(r(Y),{value:"0"},{default:l(()=>[t(r(Q),{value:"1",class:"accordion-table"},{default:l(()=>[t(r(J),null,{default:l(()=>[o("div",tt,[e.service.full_image_url?(p(),g("img",{key:0,src:e.service.full_image_url,alt:e.service.name,class:"h-6 text-sm font-normal"},null,8,at)):R("",!0),o("span",null,i(e.service.name),1)])]),_:2},1024),t(r(X),null,{default:l(()=>[t(k),t(r(Y),{value:"0"},{default:l(()=>[(p(!0),g(N,null,G(e.problems,(n,V)=>(p(),T(r(Q),{key:n.name,value:V},{default:l(()=>[t(r(J),{class:Ne({"accordion-subheader":e.service.image_url})},{default:l(()=>[v(i(n.name),1)]),_:2},1032,["class"]),t(r(X),{class:"accordion-content"},{default:l(()=>[o("div",ot,[(p(!0),g(N,null,G(n.sub_problem,(y,ge)=>(p(),g("ol",{key:ge,class:"list-disc list-inside"},[o("li",null,[o("div",lt,[o("div",nt,[o("p",st,"Kategori: "+i(y.name),1),o("div",rt,[a[16]||(a[16]=o("p",{class:"m-0"},"QTY:",-1)),t(I,{class:"inplace-custom-display"},{display:l(()=>[o("p",it,[v(i(y.qty),1),a[13]||(a[13]=o("i",{class:"pi pi-pencil ml-2"},null,-1))])]),content:l(({closeCallback:U})=>[o("div",dt,[t(w,{modelValue:y.qty,"onUpdate:modelValue":A=>y.qty=A,inputId:"horizontal-buttons",showButtons:"",buttonLayout:"horizontal",min:0,max:99,inputClass:" text-center border-l border-l-red-500 border-r border-r-green-500 bg-transparent max-w-[4rem]",incrementButtonClass:"border-green-500",decrementButtonClass:"border-red-500",small:""},{incrementbuttonicon:l(()=>a[14]||(a[14]=[o("span",{class:"pi pi-plus"},null,-1)])),decrementbuttonicon:l(()=>a[15]||(a[15]=[o("span",{class:"pi pi-minus"},null,-1)])),_:2},1032,["modelValue","onUpdate:modelValue"]),t(d,{icon:"pi pi-check",outlined:"",severity:"success",onClick:U},null,8,["onClick"])])]),_:2},1024)]),o("div",ct,[a[18]||(a[18]=o("p",{class:"m-0"},"Harga:",-1)),t(I,{class:"inplace-custom-display"},{display:l(()=>[o("p",ut,[v("Rp"+i(s.formatPrice(y.price)),1),a[17]||(a[17]=o("i",{class:"pi pi-pencil ml-2"},null,-1))])]),content:l(({closeCallback:U})=>[o("div",mt,[t(w,{modelValue:y.price,"onUpdate:modelValue":A=>y.price=A,type:"text",placeholder:"Cari Harga",inputId:"currency-indonesia",mode:"currency",currency:"IDR",locale:"id-ID",minFractionDigits:0},null,8,["modelValue","onUpdate:modelValue"]),t(d,{icon:"pi pi-check",outlined:"",severity:"success",onClick:U},null,8,["onClick"])])]),_:2},1024)])])])])]))),128))])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),t(m,{field:"properties.name",header:"Jenis Property",class:"min-w-[15rem]",sortable:""},{body:l(({data:e})=>[o("div",null,[o("p",pt,i(e.properties.name),1),e.isLadderRequired?(p(),T(_e,{key:0,value:oe(e.isLadderRequired)??"",size:"small",class:"mb-2"},null,8,["value"])):R("",!0),t(I,{class:"inplace-custom-display"},{display:l(()=>[o("p",vt,[v("Rp"+i(s.formatPrice(e.properties.fee)),1),a[19]||(a[19]=o("i",{class:"pi pi-pencil ml-2"},null,-1))])]),content:l(({closeCallback:n})=>[o("div",ft,[t(w,{modelValue:e.properties.fee,"onUpdate:modelValue":V=>e.properties.fee=V,type:"text",placeholder:"Cari Harga",inputId:"currency-indonesia",mode:"currency",currency:"IDR",locale:"id-ID",minFractionDigits:0},null,8,["modelValue","onUpdate:modelValue"]),t(d,{icon:"pi pi-check",outlined:"",severity:"success",onClick:n},null,8,["onClick"])])]),_:2},1024)])]),filter:l(({filterModel:e})=>[t(_,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,type:"text",placeholder:"Cari Property"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{sortable:"",field:"total_fee",header:"Total Harga",class:"min-w-[15rem]"},{body:l(({data:e})=>[e.total_fee?(p(),g("span",_t,"Rp"+i(s.formatPrice(e.total_fee)),1)):(p(),g("span",yt,"Harga belum ditentukan"))]),filter:l(({filterModel:e})=>[t(w,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,type:"text",placeholder:"Cari Harga",inputId:"currency-indonesia",mode:"currency",currency:"IDR",locale:"id-ID",minFractionDigits:0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{sortable:"",header:"Status",field:"status",filterMenuStyle:{width:"18rem"},class:"min-w-[20rem]"},{body:l(({data:e})=>[t(D,{value:S(e.status),severity:C(e.status),class:"whitespace-nowrap"},null,8,["value","severity"])]),filter:l(({filterModel:e})=>[t(r(O),{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,options:te,placeholder:"Pilih",showClear:""},{value:l(n=>[n.value!=null?(p(),T(D,{key:0,value:S(n.value),severity:C(n.value)},null,8,["value","severity"])):R("",!0)]),option:l(n=>[t(D,{value:S(n.option),severity:C(n.option)},null,8,["value","severity"])]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),_:1}),t(m,{sortable:"",field:"paymentMethod",header:"Metode Pembayaran",class:"min-w-[15rem]"},{body:l(({data:e})=>a[20]||(a[20]=[v(" Bank Transfer ")])),filter:l(({filterModel:e})=>[t(r(O),{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,options:ae,placeholder:"Pilih",showClear:""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),t(m,{sortable:"",field:"vendor",header:"Vendor Pilihan",class:"min-w-[15rem]"},{body:l(({data:e})=>{var n;return[t(r(O),{modelValue:f.vendor,"onUpdate:modelValue":a[2]||(a[2]=V=>f.vendor=V),options:r(le),value:(n=e==null?void 0:e.vendor_id)==null?void 0:n.name,filter:"",optionLabel:"name",placeholder:"Pilih Vendor",class:"w-[15rem]"},null,8,["modelValue","options","value"])]}),filter:l(({filterModel:e})=>[t(_,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,type:"text",placeholder:"Cari Vendor"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{sortable:"",header:"Tanggal Pesanan",filterField:"date",dataType:"date",class:"min-w-[20rem]"},{body:l(({data:e})=>[v(i(se(e.created_at)),1)]),filter:l(({filterModel:e})=>[t(r(Le),{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,dateFormat:"mm/dd/yy",placeholder:"mm/dd/yyyy"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{sortable:"",field:"id",header:"Action",bodyClass:"text-center",class:"min-w-[10rem]"},{body:l(({data:e})=>[o("div",gt,[B(t(d,{icon:"pi pi-external-link",severity:"info",text:"",as:"router-link",to:{name:"order-detail",params:{id:e.id}}},null,8,["to"]),[[P,"Detail Pesanan",void 0,{bottom:!0}]]),B(t(d,{icon:"pi pi-send",severity:"success",text:"",onClick:n=>ie(e.id)},null,8,["onClick"]),[[P,"Teruskan Pesanan",void 0,{bottom:!0}]]),B(t(d,{icon:"pi pi-times",severity:"danger",text:"",onClick:n=>z(e.id)},null,8,["onClick"]),[[P,"Batalkan",void 0,{bottom:!0}]]),t(r(Z),{ref_key:"opCancelConfirm",ref:M,class:"p-0 min-w-[20rem]"},{default:l(()=>[a[22]||(a[22]=o("h6",{class:"mb-2"},"Pembatalan Pesanan",-1)),o("div",bt,[o("div",ht,[a[21]||(a[21]=o("label",{for:"message"},"Beri alasan",-1)),t(E,{modelValue:f.reason,"onUpdate:modelValue":a[3]||(a[3]=n=>f.reason=n),id:"message"},null,8,["modelValue"])]),o("div",Vt,[t(d,{label:"Batal",severity:"secondary",text:"",onClick:a[4]||(a[4]=n=>z(n))}),t(d,{label:"Submit",onClick:n=>re(e.id)},null,8,["onClick"])])])]),_:2},1536)])]),_:1})]),_:1},8,["value","filters","loading"]))]),t(r(je))],64)}}});export{Et as default};

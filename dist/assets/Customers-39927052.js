import{s as P}from"./index-9ddf3d55.js";import{s as F,a as j}from"./index-ef5991cc.js";import{s as R}from"./index-b12d1d5d.js";import{s as L}from"./index-9ea91010.js";import{Y as X,$ as C,a0 as I,d as D,r as q,o as U,c as M,b as s,f as l,e as o,J as u,N as h,L as B,S as Z,a as _,P as ee,D as le,i as T,y as ae,H as A,z as E,W as S,X as N}from"./index-2917ce10.js";import{s as te}from"./index-21298692.js";import{s as oe,a as ne}from"./index-547ca5e5.js";import{s as se,a as ie}from"./index-6372ac25.js";import{_ as re}from"./TopBreadcrumb-739057b0.js";import{s as de}from"./index-6240175d.js";import"./index-775fa504.js";import"./index-5646386e.js";import"./index-002ee94f.js";import"./index-4a56db6f.js";import"./index-2f177586.js";import"./index-83a3f0d6.js";import"./_plugin-vue_export-helper-c27b6911.js";const H=X("UserStore",{state:()=>({isLoading:!1,users:[],detail:{}}),actions:{async getAll(f=""){this.isLoading=!0;try{const i=await C.get(`/auth/users?role_id=${f}`);return this.users=i.data,i}catch{}finally{this.isLoading=!1}},async create(f){this.isLoading=!0;try{const i=await C.post("/auth/users",f);return I("success",i.message)}catch{}finally{this.isLoading=!1}},async update(f,i){this.isLoading=!0;try{const p=await C.post(`/auth/users/${i}`,f);return I("success",p.message)}catch{}finally{this.isLoading=!1}},async delete(f){this.isLoading=!0;try{const i=await C.delete(`/auth/users/${f}`);I("success",i.message)}catch{}finally{this.isLoading=!1}}}}),ue={class:"flex flex-col gap-2 mb-4"},me={class:"flex flex-col gap-2 mb-4"},pe={class:"flex flex-col gap-2"},ce={class:"flex justify-end gap-2 mt-8"},fe=D({__name:"EditCustomer",props:{customer:{type:Object,required:!0}},emits:["on-close","on-save"],setup(f,{emit:i}){const p=f,g=i,r=H(),d=q({name:p.customer.name,email:p.customer.email,phone:p.customer.phone?p.customer.phone.slice(3):""});async function c(){var t;const n={_method:"PATCH",name:d.name,email:d.email,phone:`+62${((t=d.phone)==null?void 0:t.toString())||""}`};await r.update(n,p.customer.id),g("on-save")}return(n,t)=>{const b=L,v=F,$=R,x=j,m=P;return U(),M(B,null,[s("div",ue,[t[5]||(t[5]=s("label",{for:"name"},"Nama Pelanggan",-1)),l(b,{modelValue:o(d).name,"onUpdate:modelValue":t[0]||(t[0]=e=>o(d).name=e),id:"name","aria-describedby":"name-help",placeholder:"Masukkan nama lengkap pelanggan"},null,8,["modelValue"])]),s("div",me,[t[6]||(t[6]=s("label",{for:"email"},"Nomor Hp Pelanggan",-1)),l(b,{modelValue:o(d).email,"onUpdate:modelValue":t[1]||(t[1]=e=>o(d).email=e),id:"email","aria-describedby":"phone-help",placeholder:"Masukkan email pelanggan"},null,8,["modelValue"])]),s("div",pe,[t[8]||(t[8]=s("label",{for:"phone"},"Nomor Hp",-1)),l(x,null,{default:u(()=>[l(v,null,{default:u(()=>t[7]||(t[7]=[h(" +62 ")])),_:1}),l($,{modelValue:o(d).phone,"onUpdate:modelValue":t[2]||(t[2]=e=>o(d).phone=e),id:"phone",inputId:"withoutgrouping",useGrouping:!1,fluid:"",placeholder:"Masukkan no hp pelanggan"},null,8,["modelValue"])]),_:1})]),s("div",ce,[l(m,{type:"button",label:"Batal",text:"",severity:"secondary",onClick:t[3]||(t[3]=e=>g("on-close"))}),l(m,{type:"button",label:"Simpan",disabled:n.$isQueryInvalid(o(d)),loading:o(r).isLoading,onClick:t[4]||(t[4]=e=>c())},null,8,["disabled","loading"])])],64)}}}),ge={class:"flex flex-col gap-2 mb-4"},ve={class:"flex flex-col gap-2 mb-4"},be={class:"flex flex-col gap-2"},ye={class:"flex justify-end gap-2 mt-8"},_e=D({__name:"AddCustomer",emits:["on-close","on-save"],setup(f,{emit:i}){const p=i,g=H(),r=q({name:"",email:"",phone:null});async function d(){var c;r.phone=`+62${((c=r.phone)==null?void 0:c.toString())||""}`,await g.create(r),p("on-save")}return(c,n)=>{const t=L,b=F,v=R,$=j,x=P;return U(),M(B,null,[s("div",ge,[n[5]||(n[5]=s("label",{for:"name"},"Nama Pelanggan",-1)),l(t,{modelValue:o(r).name,"onUpdate:modelValue":n[0]||(n[0]=m=>o(r).name=m),id:"name","aria-describedby":"name-help",placeholder:"Masukkan nama lengkap pelanggan"},null,8,["modelValue"])]),s("div",ve,[n[6]||(n[6]=s("label",{for:"email"},"Email",-1)),l(t,{modelValue:o(r).email,"onUpdate:modelValue":n[1]||(n[1]=m=>o(r).email=m),id:"email","aria-describedby":"phone-help",placeholder:"Masukkan email pelanggan"},null,8,["modelValue"])]),s("div",be,[n[8]||(n[8]=s("label",{for:"phone"},"Nomor Hp",-1)),l($,null,{default:u(()=>[l(b,null,{default:u(()=>n[7]||(n[7]=[h(" +62 ")])),_:1}),l(v,{modelValue:o(r).phone,"onUpdate:modelValue":n[2]||(n[2]=m=>o(r).phone=m),id:"phone",inputId:"withoutgrouping",useGrouping:!1,fluid:"",placeholder:"Masukkan no hp pelanggan"},null,8,["modelValue"])]),_:1})]),s("div",ye,[l(x,{type:"button",label:"Batal",text:"",severity:"secondary",onClick:n[3]||(n[3]=m=>p("on-close"))}),l(x,{type:"button",label:"Simpan",disabled:c.$isQueryInvalid(o(r)),loading:o(g).isLoading,onClick:n[4]||(n[4]=m=>d())},null,8,["disabled","loading"])])],64)}}}),xe={class:"card mt-8"},he={class:"flex flex-col md:flex-row justify-between gap-4"},$e={class:"flex items-center gap-4 md:order-2 order-1"},Ve={class:"hidden md:flex"},ke={class:"flex md:hidden"},we=["href"],Ce={class:"flex gap-4 items-center"},Re=D({__name:"Customers",setup(f){const i=H(),p=Z(),g=_(),r=_({global:{value:null,matchMode:S.CONTAINS},name:{operator:N.AND,constraints:[{value:null,matchMode:S.STARTS_WITH}]},email:{operator:N.AND,constraints:[{value:null,matchMode:S.STARTS_WITH}]},phone:{operator:N.AND,constraints:[{value:null,matchMode:S.STARTS_WITH}]}}),d=_(!1),c=_(!1),n=_(0),t=_(!1),b=_(null);async function v(){await i.getAll(1),n.value+=1}ee(async()=>{await v()});const $=m=>{g.value.exportCSV()},x=m=>{p.require({target:m.currentTarget,message:"Yakin ingin menghapus data pelanggan ini?",icon:"pi pi-info-circle",rejectProps:{label:"Batal",severity:"secondary",outlined:!0},acceptProps:{label:"Yakin",severity:"danger"},accept:async()=>{await i.delete(m),await v()}})};return(m,e)=>{const W=re,V=P,z=se,k=L,Y=ie,w=ne,K=oe,Q=_e,G=te,J=fe,O=ae("tooltip");return U(),M(B,null,[l(W,{breadcrumbItems:[{label:"Pelanggan"}]}),s("div",xe,[e[13]||(e[13]=s("div",{class:"font-semibold text-xl mb-4"},"Data Pelanggan",-1)),(U(),le(K,{ref_key:"dt",ref:g,key:o(n),value:o(i).users,paginator:!0,rows:10,dataKey:"id",rowHover:!0,filters:o(r),"onUpdate:filters":e[3]||(e[3]=a=>T(r)?r.value=a:null),filterDisplay:"menu",loading:o(t),globalFilterFields:["name","email","phone"],showGridlines:""},{header:u(()=>[s("div",he,[l(V,{type:"button",icon:"pi pi-plus",label:"Tambah Pelanggan",class:"md:order-1 order-2",onClick:e[0]||(e[0]=a=>c.value=!0)}),s("div",$e,[s("div",Ve,[l(V,{type:"button",icon:"pi pi-download",outlined:"",label:"Unduh",onClick:e[1]||(e[1]=a=>$(a))})]),s("div",ke,[l(V,{type:"button",icon:"pi pi-download",outlined:""})]),l(Y,{class:"w-full md:w-auto"},{default:u(()=>[l(z,null,{default:u(()=>e[10]||(e[10]=[s("i",{class:"pi pi-search"},null,-1)])),_:1}),l(k,{modelValue:o(r).global.value,"onUpdate:modelValue":e[2]||(e[2]=a=>o(r).global.value=a),placeholder:"Pencarian",fluid:""},null,8,["modelValue"])]),_:1})])])]),empty:u(()=>e[11]||(e[11]=[h(" Tidak ada data Pelanggan. ")])),loading:u(()=>e[12]||(e[12]=[h(" Memuat data Pelanggan. Mohon tunggu. ")])),default:u(()=>[l(w,{sortable:"",field:"name",header:"Nama",class:"min-w-[15rem]"},{body:u(({data:a})=>[h(A(a.name),1)]),filter:u(({filterModel:a})=>[l(k,{modelValue:a.value,"onUpdate:modelValue":y=>a.value=y,type:"text",placeholder:"Cari Pelanggan"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(w,{sortable:"",field:"email",header:"Alamat Email",class:"min-w-[15rem]"},{body:u(({data:a})=>[s("a",{href:"mailto:"+a.email,class:"text-blue-400 hover:text-blue-500 transition-all",target:"_blank"},A(a.email),9,we)]),filter:u(({filterModel:a})=>[l(k,{modelValue:a.value,"onUpdate:modelValue":y=>a.value=y,type:"text",placeholder:"Cari Pelanggan"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(w,{sortable:"",field:"phone",header:"Nomor Hp",class:"min-w-[15rem]"},{body:u(({data:a})=>[h(A(a.phone),1)]),filter:u(({filterModel:a})=>[l(k,{modelValue:a.value,"onUpdate:modelValue":y=>a.value=y,type:"text",placeholder:"Cari Pelanggan"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(w,{sortable:"",field:"id",header:"Action",bodyClass:"text-center",class:"min-w-[10rem]"},{body:u(({data:a})=>[s("div",Ce,[E(l(V,{icon:"pi pi-pencil",severity:"info",text:"",onClick:y=>(b.value=a,d.value=!0)},null,8,["onClick"]),[[O,"Ubah",void 0,{bottom:!0}]]),E(l(V,{icon:"pi pi-trash",severity:"danger",text:"",onClick:y=>x(a.id)},null,8,["onClick"]),[[O,"Hapus",void 0,{bottom:!0}]])])]),_:1})]),_:1},8,["value","filters","loading"]))]),l(o(de)),l(G,{visible:o(c),"onUpdate:visible":e[6]||(e[6]=a=>T(c)?c.value=a:null),maximizable:"",modal:"",header:"Tambah Pelanggan",class:"sm:w-1/2 w-full"},{default:u(()=>[l(Q,{onOnClose:e[4]||(e[4]=a=>c.value=!1),onOnSave:e[5]||(e[5]=a=>(c.value=!1,v()))})]),_:1},8,["visible"]),l(G,{visible:o(d),"onUpdate:visible":e[9]||(e[9]=a=>T(d)?d.value=a:null),maximizable:"",modal:"",header:"Ubah Pelanggan",class:"sm:w-1/2 w-full"},{default:u(()=>[l(J,{customer:o(b),onOnClose:e[7]||(e[7]=a=>d.value=!1),onOnSave:e[8]||(e[8]=a=>(d.value=!1,v()))},null,8,["customer"])]),_:1},8,["visible"])],64)}}});export{Re as default};
